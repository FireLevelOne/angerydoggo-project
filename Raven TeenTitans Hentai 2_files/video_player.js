function videoPlayer(width,height,params,swf_player){var self=this;this.canPlayFlash=function(){return(typeof(swfobject)!='undefined'&&swfobject.hasFlashPlayerVersion("9.0.0"));}
this.canPlayMP4=function(){var v=document.createElement('video');if(v.canPlayType&&v.canPlayType('video/mp4').replace(/no/,'')){return true;}
return false;}
function doEmbed(element_id){if(!self.canPlayFlash()&&!self.canPlayMP4())return false;if(element_id===null){element_id='new_video_player';if(!document.getElementById(element_id)){document.write("<div id='"+element_id+"'></div>");}}
if(self.canPlayFlash()){flashvars=[];for(var p in params){flashvars[p]=escape(params[p]);}
swfobject.embedSWF(swf_player,element_id,width,height,"9.0.0",null,flashvars,{wmode:'direct',allowscriptaccess:'never',allowfullscreeninteractive:'true',allowfullscreen:'true'});}else{var possible_resolutions=[{name:'360p',width:640,height:360},{name:'720p',width:1280,height:720},{name:'1080p',width:1920,height:1080}];var resolutions=[];var resolution=possible_resolutions[0];for(var i=0;i<possible_resolutions.length;i++){if(params.max_resolution>=possible_resolutions[i].height){resolutions.push(possible_resolutions[i]);if(possible_resolutions[i].width<=width&&possible_resolutions[i].height<=height){resolution=possible_resolutions[i];}}}
var video_parts=params.url.split(".");video_parts.pop();var src=video_parts.join(".")+"."+ resolution.name+".mp4";var html="<video style='background-color:#000' id='"+element_id+"_video' width='"+width+"' height='"+height+"' controls autoplay preload>\n";html+="<source id='"+element_id+"_source' src='"+src+"' type='video/mp4' />";html+="</video>";var element=document.getElementById(element_id);var container=document.createElement('div');container.id=element_id;container.innerHTML=html;element.parentNode.replaceChild(container,element);}}
this.embed=function(element_id){if(element_id){if(typeof(jQuery)=='undefined'){var onloaded=function(){doEmbed(element_id);}
if(document.readyState=="complete"||document.readyState=="loaded"||document.readyState=="interactive"){onloaded();}else if(document.addListener){document.addListener("DOMContentLoaded",onloaded,false);}else{document.attachEvent("onDOMContentLoaded",onloaded,false);}}else{jQuery(function(){doEmbed(element_id);});}}else{doEmbed(null);}};}